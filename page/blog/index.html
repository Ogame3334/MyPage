<!DOCTYPE html>
<html>
    <head id="head">
        <title>Ogame's Page</title>
        <link href="../../styles/style.css" rel="stylesheet">
        <link href="../../styles/blog.css" rel="stylesheet">
        <link rel="icon" type="image/png" href="../../images/icon.jpg">
        <link rel="shortcut icon" href="../../images/icon.jpg" type="image/x-icon" />
        <link rel="apple-touch-icon-precomposed" href="../../images/icon.jpg" />
        <meta name="msapplication-TileImage" content="../../images/icon.jpg" />
        <meta name="msapplication-TileColor" content="#78A800"/>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <meta name="description" content="緑獺おがめのマイページです" />
        <meta property="og:url" content="https://ogame3334.github.io/MyPage/page/top/" />
        <meta property="og:title" content="緑獺おがめのマイページ" /> 
        <meta property="og:description" content="緑獺おがめのマイページ - Top" /> 
        <meta property="og:image" content="../../images/icon.png" />
        
    </head>
    <body>
        <div class="start-up", id="start-up">
            <div class="start-up-back", id="start-up-back"></div>
            <div class="start-up-square" id="start-up-square-left" style="outline-color: yellow;"></div>
            <div class="start-up-square" id="start-up-square-right" style="left: 70%; outline-color: aqua; transform: rotate(45deg);"></div>
        </div>
        <div>
            <div class="header-container">
                <div class="header-subtitle" id="header-subtitle">
                    <div class="header-subtitle-contents">
                        <a href="../../page/top/" class="header-subtitle-name">トップ</a>
                        <a href=""class="header-subtitle-name">作品</a>
                        <a href="../../page/blog/"class="header-subtitle-name">ブログ</a>
                    </div>
                </div>
                <header class="header" id="header">
                    <div class="header-content">
                        <div class="header-title">
                            <a href="../../">
                                <h1>
                                    Ogame's Page
                                </h1>
                            </a>
                        </div>
                        <div class="menu-button" id="menu-button">
                            <div class="menu-button-line" style="transform: matrix(1, 0, 0, 1, 0, 7.14);"></div>
                            <div class="menu-button-line" style="transform: matrix(1, 0, 0, 1, 0, 14.28);"></div>
                            <div class="menu-button-line" style="transform: matrix(1, 0, 0, 1, 0, 21.42);"></div>
                        </div>
                    </div>
                </header>
            </div>
            <main class="main" id="main" style="display: flex;">
                <div class="blog-side-menu">
                    <div class="blog-side-menu-inner">
                        <!-- <h2>hoge</h2> -->
                        <li><a href="../blog/">トップへ</a></li>
                    </div>
                    <div class="blog-side-menu-inner-headline" id="blog-side-menu-inner-headline">

                    </div>
                </div>
                <div class="blog-main-content" id="blog-main-content">
                    <script>
                        class headline {
                            constructor(id_name, sentence) {
                                this.id_name = id_name;
                                this.sentence = sentence;
                            }
                        }

                        function gen_side_menu_html(headline_list) {
                            var side_menu = document.getElementById('blog-side-menu-inner-headline');
                            side_menu.innerHTML = "<h2>目次</h2>\n";
                            headline_list.forEach(element => {
                                side_menu.innerHTML += `<li><a href="#${element.id_name}">${element.sentence}</a></li>\n`
                            });
                        }

                        async function MDtoHtml(data) {
                            var headline_list = [];

                            await markdown.ready;

                            var md = markdown.parse(md_data);
                            md = md.replace('<table>', '<table border="1">');
                            md = md.replace('<h1>', '<h1 id="title">');
                            md = md.replaceAll('<a id="" class="anchor" aria-hidden="true" href="#"></a>', '');
                            md = md.replaceAll('<h2>', '<h2 class="headline">');
                            
                            var i = 0;
                            while(true) {
                                var temp = md.replace('<h2 class="headline">', `<h2 class="headline anchor" id="headline-${i}">`);
                                if(temp == md){
                                    break;
                                }
                                var temp_headline_name = temp.split(`id="headline-${i}">`)[1].split('</h2>')[0];
                                temp_headline = new headline(`headline-${i}`, temp_headline_name);
                                headline_list.push(temp_headline);
                                md = temp;
                                i++;
                            }
                            
                            gen_side_menu_html(headline_list);

                            var hoge = document.getElementById('blog-main-content');
                            hoge.innerHTML = md;
                        }

                        var md_data = "";

                        var blog_num = "";

                        const param = window.location.search;
                        if(/\?n=\d/.test(param)) {
                            blog_num = ('000' + param.replace('?n=', '')).slice(-3);
                            
                            fetch(`./page/blog_${blog_num}/blog_${blog_num}.md`)
                                .then(response => response.text())
                                .then(data => {
                                    md_data = data;
    
                                    MDtoHtml(data);
                                })
                                .catch(error => {
                                    console.error(error);
                                });
                        }
                        else{

                        }

                    </script>
                    <div class="blog-main-content-footer-button">
                        <a>&lt;&lt; 前の記事へ</a>
                        <a style="margin-left: auto;">次の記事へ &gt;&gt;</a>
                    </div>
                </div>
            </main>
        </div>
        <script src='https://cdn.jsdelivr.net/gh/rsms/markdown-wasm@v1.1.2/dist/markdown.js'></script>
        <script src="../../scripts/script.js"></script>
    </body>
</html>